Cohort Analysis of Online Cinema Using SQL< / Когортный анализ онлайн-кинотеатра с помощью SQL

I needed to plot the distribution of money paid out by customers in an online movie theater by month.
Complete the query to get three different moving averages (by amount of money by month): a. MA(3) is a moving average, taking the current value and the two previous values. b. MA(7) is a moving average taking the current value and the six previous ones. c. MA_2side(5) - a two-sided moving average taking the current value, the previous two and the next two.
Visualize the obtained results in Metabase.


*Мне нужно было построить распределение выплаченных клиентами денег в он-лайн-кинотеатре по месяцам.
Дополнить запрос, чтобы получить три разных скользящих средних (по сумме денег по месяцам): a. MA(3) - скользящее среднее, принимающее текущее значение и два предыдущих. b. MA(7) - скользящее среднее, принимающее текущее значение и шесть предыдущих. c. MA_2side(5) - двустороннее скользящее среднее, принимающее текущее значение, два предыдущих и два следующих.
Визуализировать полученные результаты в Metabase.
